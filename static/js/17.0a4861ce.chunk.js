(this["webpackJsonpgame-caro"]=this["webpackJsonpgame-caro"]||[]).push([[17],{199:function(e,a,t){"use strict";var n=t(2),s=t(4),r=t(0),o=(t(22),t(23)),c=t(181),i=t(27),l=t(36),m=t(182),d=t(180),h=r.forwardRef((function(e,a){var t=e.children,i=e.classes,h=e.className,u=e.color,p=void 0===u?"primary":u,f=e.component,g=void 0===f?"div":f,b=e.disabled,v=void 0!==b&&b,C=e.error,O=void 0!==C&&C,k=e.fullWidth,j=void 0!==k&&k,y=e.focused,E=e.hiddenLabel,w=void 0!==E&&E,N=e.margin,x=void 0===N?"none":N,U=e.required,D=void 0!==U&&U,B=e.size,S=e.variant,T=void 0===S?"standard":S,W=Object(s.a)(e,["children","classes","className","color","component","disabled","error","fullWidth","focused","hiddenLabel","margin","required","size","variant"]),A=r.useState((function(){var e=!1;return t&&r.Children.forEach(t,(function(a){if(Object(m.a)(a,["Input","Select"])){var t=Object(m.a)(a,["Select"])?a.props.input:a;t&&Object(c.a)(t.props)&&(e=!0)}})),e})),R=A[0],L=A[1],P=r.useState((function(){var e=!1;return t&&r.Children.forEach(t,(function(a){Object(m.a)(a,["Input","Select"])&&Object(c.b)(a.props,!0)&&(e=!0)})),e})),I=P[0],_=P[1],F=r.useState(!1),M=F[0],q=F[1],z=void 0!==y?y:M;v&&z&&q(!1);var G=r.useCallback((function(){_(!0)}),[]),J={adornedStart:R,setAdornedStart:L,color:p,disabled:v,error:O,filled:I,focused:z,fullWidth:j,hiddenLabel:w,margin:("small"===B?"dense":void 0)||x,onBlur:function(){q(!1)},onEmpty:r.useCallback((function(){_(!1)}),[]),onFilled:G,onFocus:function(){q(!0)},registerEffect:void 0,required:D,variant:T};return r.createElement(d.a.Provider,{value:J},r.createElement(g,Object(n.a)({className:Object(o.a)(i.root,h,"none"!==x&&i["margin".concat(Object(l.a)(x))],j&&i.fullWidth),ref:a},W),t))}));a.a=Object(i.a)({root:{display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top"},marginNormal:{marginTop:16,marginBottom:8},marginDense:{marginTop:8,marginBottom:4},fullWidth:{width:"100%"}},{name:"MuiFormControl"})(h)},315:function(e,a,t){"use strict";t.r(a);var n=t(13),s=t(14),r=t(51),o=t(16),c=t(15),i=t(0),l=t.n(i),m=t(19),d=t(27),h=t(8),u=t(46),p=(t(176),t(102)),f=t(160),g=t(29),b=t(55),v=t(184),C=t(167),O=t(45),k=t(168),j=t(175),y=function(e){Object(o.a)(t,e);var a=Object(c.a)(t);function t(e){var s;return Object(n.a)(this,t),(s=a.call(this,e)).state={name:"",chessman:null,chessmanPreview:"",chessmanName:"",progressUploadBackground:0,isLoading:!1,successOpen:!1,errorOpen:!1},s.handleCloseNotice=s.handleCloseNotice.bind(Object(r.a)(s)),s.handleChessman=s.handleChessman.bind(Object(r.a)(s)),s.removeChessman=s.removeChessman.bind(Object(r.a)(s)),s.uploadChessman=s.uploadChessman.bind(Object(r.a)(s)),s.handleChange=s.handleChange.bind(Object(r.a)(s)),s.inputAvatarRef=l.a.createRef(),s}return Object(s.a)(t,[{key:"componentDidMount",value:function(){}},{key:"handleChessman",value:function(e){this.setState({chessman:e.target.files[0],chessmanPreview:URL.createObjectURL(e.target.files[0]),chessmanName:e.target.files[0].name})}},{key:"removeChessman",value:function(){this.setState({chessman:null,chessmanPreview:"",chessmanName:""})}},{key:"uploadChessman",value:function(){var e=this,a=this.state,t=a.name,n=a.chessman,s=this.props.dataUserAuth;if(this.setState({isLoading:!0}),n){var r=(s&&s.uid?s.uid:"")+"_"+(new Date).getTime();g.b.ref("images/chessmans/".concat(r)).put(n).on("state_changed",(function(a){var t=Math.round(a.bytesTransferred/a.totalBytes*100);e.setState({progressUploadBackground:t})}),(function(a){e.setState({isLoading:!1,progressUploadBackground:0,errorOpen:!0})}),(function(){g.b.ref("images/chessmans").child(r).getDownloadURL().then((function(a){g.a.database().ref("chessmans/"+r).set({userId:s.uid,chessmanUrl:a,chessmanId:r,name:t,updateAt:(new Date).getTime(),default:0},(function(a){a?e.setState({name:"",chessman:null,chessmanPreview:"",chessmanName:"",progressUploadBackground:0,isLoading:!1,errorOpen:!0}):e.setState({name:"",chessman:null,chessmanPreview:"",chessmanName:"",progressUploadBackground:0,isLoading:!1,successOpen:!0})}))}))}))}}},{key:"handleChange",value:function(e,a){this.setState(Object(u.a)({},e,a))}},{key:"handleCloseNotice",value:function(){this.setState({successOpen:!1,errorOpen:!1})}},{key:"render",value:function(){var e=this,a=this.state,t=a.name,n=a.chessman,s=a.chessmanPreview,r=a.chessmanName,o=a.progressUploadBackground,c=a.isLoading,i=a.successOpen,m=a.errorOpen,d=this.props,h=d.classes;d.dataUserAuth;return l.a.createElement("div",{className:h.chessmanWrapper},c&&l.a.createElement(b.a,null),l.a.createElement(j.a,{className:h.nameChessman,name:"name",value:t,type:"text",placeholder:O.a.t("chessman.upload_chessman.nameChessman"),onChange:function(a){return e.handleChange("name",a.target.value)}}),l.a.createElement("div",{className:h.chessmanPhoto},l.a.createElement(v.a,{onChange:this.handleChessman,removePhoto:this.removeChessman,photo:n,photoPreview:s,photoName:r,progressUploadBackground:o})),l.a.createElement(f.a,{onClick:function(){return e.uploadChessman()},className:h.uploadBgBtn},O.a.t("background.upload_background.btn_upload")),l.a.createElement(C.a,{snackbarProps:{open:i,onClose:this.handleCloseNotice},message:O.a.t("alert.success")}),l.a.createElement(k.a,{snackbarProps:{open:m,onClose:this.handleCloseNotice},message:O.a.t("alert.error")}))}}]),t}(l.a.Component),E=Object(h.d)(Object(m.b)((function(e){return{dataUserAuth:e.authReducer.dataUserAuth}}),(function(e){return{}})),Object(d.a)((function(e){return{chessmanWrapper:{height:"100%",width:"100%",display:"flex",flexDirection:"column",overflow:"hidden"},chessmanPhoto:{width:180,height:180,margin:"auto"},nameChessman:{width:300,margin:"auto"},uploadBgBtn:{marginTop:"1rem",backgroundColor:"#123152",textTransform:"initial",padding:"0.5rem 1.5rem",fontWeight:600,borderRadius:9,marginBottom:"1rem",color:"#dfe3f1",width:300,margin:"auto","&:hover":{backgroundColor:"#123152"}}}})),Object(p.a)())(y),w=t(164),N=t(73),x=t(72),U=t(6),D=t(7),B=t(166),S=t(10),T=t(206),W=t(63),A=t(141),R=function(e){Object(o.a)(t,e);var a=Object(c.a)(t);function t(e){var s;return Object(n.a)(this,t),(s=a.call(this,e)).state={dataChessmans:[],loadingData:!1},s.getDataChessmans=s.getDataChessmans.bind(Object(r.a)(s)),s.setChessmanDefault=s.setChessmanDefault.bind(Object(r.a)(s)),s}return Object(s.a)(t,[{key:"componentDidMount",value:function(){this.getDataChessmans()}},{key:"getDataChessmans",value:function(){var e=this;g.a.database().ref("chessmans/").orderByChild("default").on("value",(function(a){if(a.val()){var t=[];Object.keys(a.val()).map((function(e,n){t.push(a.val()[e])})),t.sort((function(e,a){return a.default-e.default}));var n=t.filter((function(e){return e.default})).sort((function(e,a){return a.updateAt-e.updateAt})),s=t.filter((function(e){return!e.default})).sort((function(e,a){return a.updateAt-e.updateAt}));t=n.concat(s),e.setState({dataChessmans:t,loadingData:!0})}else e.setState({loadingData:!0})}))}},{key:"setChessmanDefault",value:function(e,a){var t=this;g.a.database().ref("chessmans/"+e.chessmanId).set(Object(S.a)(Object(S.a)({},e),{},{updateAt:(new Date).getTime(),default:a}),(function(e){e||t.getDataChessmans()}))}},{key:"render",value:function(){var e=this,a=this.state,t=a.dataChessmans,n=a.loadingData,s=this.props.classes;return l.a.createElement("div",{className:s.listChessmanWrapper},n?Array.isArray(t)&&t.length?l.a.createElement("div",{className:s.chessmanList},t.map((function(a,t){return l.a.createElement("div",{className:s.chessmanItem},l.a.createElement("div",{className:"dataWrapper"},l.a.createElement("img",{src:a.chessmanUrl,alt:""})),l.a.createElement("div",{className:"nameChess"},a.name?a.name:""),l.a.createElement("div",{className:"checkWrapper"},0===t||1===t?l.a.createElement(f.a,{className:"checkBackground",onClick:function(){return e.setChessmanDefault(a,0)}},l.a.createElement(T.a,{width:36,height:36})):l.a.createElement(f.a,{className:"checkBackground",onClick:function(){return e.setChessmanDefault(a,1)}})))}))):l.a.createElement("div",{className:s.notBg},l.a.createElement("span",{className:"text"},O.a.t("chessman.list_chessman.text_not_bg")),l.a.createElement(f.a,{onClick:function(){e.props.goToUploadChessman()},className:"btnGoToUpload"},O.a.t("chessman.list_chessman.goUploadChessman"))):l.a.createElement("div",{className:s.loadingWrapper},l.a.createElement(A.a,{color:"#123152"})))}}]),t}(l.a.Component),L=Object(h.d)(Object(m.b)((function(e){return{dataUserAuth:e.authReducer.dataUserAuth,dataUser:e.gameReducer.dataUser}}),(function(e){return{saveDataUser:function(a,t){return e(W.d(a,t))},showDataUser:function(a){return e(W.i(a))}}})),Object(d.a)((function(e){return{listChessmanWrapper:{height:"100%"},chessmanList:{},chessmanItem:{display:"flex",alignItems:"center",height:180,justifyContent:"flex-end",padding:"0.5rem 0rem","& .dataWrapper":{height:"100%",display:"flex",alignItems:"center",justifyContent:"flex-start",width:"100%",padding:"0.5rem 1rem",backgroundColor:"#bfdcae",borderRadius:9,"& img":{objectFit:"cover",height:"100%",maxWidth:"100%"}},"& .nameChess":{width:200,padding:"0.5rem",color:"#123152",fontWeight:600},"& .checkWrapper":{padding:"0rem 0.5rem","& .checkBackground":{width:48,height:48,backgroundColor:"#fff",minWidth:"auto","& svg":{"& path":{fill:"#123152",stroke:"#123152"}}}}},notBg:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%","& .text":{color:"#123152",fontWeight:600,fontSize:"1.8rem",paddingBottom:"1rem"},"& .btnGoToUpload":{backgroundColor:"#123152",textTransform:"initial",padding:"0.5rem 1.5rem",fontWeight:600,borderRadius:9,marginBottom:"1rem",color:"#dfe3f1","&:hover":{backgroundColor:"#123152"}}},loadingWrapper:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"}}})),Object(p.a)(),U.g)(R),P=["list-chessmans","upload-chessman"],I=function(e){Object(o.a)(t,e);var a=Object(c.a)(t);function t(e){var s;return Object(n.a)(this,t),(s=a.call(this,e)).state={valueOptionChessman:"list-chessmans"},s.changeChessmanType=s.changeChessmanType.bind(Object(r.a)(s)),s}return Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=new URLSearchParams(window.location.search.substr(1)).entries(),a=Object(B.b)(e);if(a.hasOwnProperty("chessmanType")){var t=a.chessmanType;P.includes(t)?this.setState({valueOptionChessman:t}):(this.setState({valueOptionChessman:"list-chessmans"}),this.props.history.push(D.d+"?chessmanType=list-chessmans"))}else this.setState({valueOptionChessman:"list-chessmans"}),this.props.history.push(D.d+"?chessmanType=list-chessmans")}},{key:"changeChessmanType",value:function(e){this.setState({valueOptionChessman:e}),this.props.history.push(D.d+"?chessmanType="+e)}},{key:"render",value:function(){var e=this,a=this.state.valueOptionChessman,t=this.props,n=t.classes;t.dataUserAuth;return l.a.createElement(l.a.Fragment,null,l.a.createElement(w.a,null),l.a.createElement(x.a,null,l.a.createElement("div",{className:n.chessmanWrapper},l.a.createElement("div",{className:n.headerChessman},l.a.createElement(f.a,{onClick:function(){return e.changeChessmanType("list-chessmans")},className:"menuItem"+("list-chessmans"===a?" active":"")},O.a.t("chessman.menu.list_chessman")),l.a.createElement(f.a,{onClick:function(){return e.changeChessmanType("upload-chessman")},className:"menuItem"+("upload-chessman"===a?" active":"")},O.a.t("chessman.menu.upload_chessman"))),l.a.createElement("div",{className:n.contentChessman},"list-chessmans"===a?l.a.createElement(L,{goToUploadChessman:function(){return e.changeChessmanType("upload-chessman")}}):l.a.createElement(E,null)))),l.a.createElement(N.a,null))}}]),t}(l.a.Component);a.default=Object(h.d)(Object(m.b)((function(e){return{dataUserAuth:e.authReducer.dataUserAuth}}),(function(e){return{}})),Object(d.a)((function(e){return{chessmanWrapper:{width:"90%",margin:"auto",height:"100%",display:"flex",flexDirection:"column"},headerChessman:{paddingTop:"1rem",borderBottom:"2px dashed #f1f3de",marginBottom:"1rem","& .menuItem":{textTransform:"initial",borderRadius:"11px 11px 0px 0px",fontWeight:600,color:"#f1f3de",padding:"0.5rem 1rem","&.active":{border:"2px solid #f1f3de",backgroundColor:"#f1f3de",color:"#123152"}}},contentChessman:{flexGrow:1,overflowY:"scroll",backgroundColor:"#e0ece4",padding:"1rem 0.5rem",borderRadius:9,boxShadow:"0 5px 5px 0 #e0ece4","&::-webkit-scrollbar":{width:9},"&::-webkit-scrollbar-track":{background:"#ee6f57",borderRadius:9},"&::-webkit-scrollbar-thumb":{borderRadius:9,background:"#ee6f57"}}}})),Object(p.a)(),U.g)(I)}}]);
//# sourceMappingURL=17.0a4861ce.chunk.js.map